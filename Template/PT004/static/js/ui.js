(function(win,doc,$, undefined){    jQuery.easing.def = "easeInOutSine";    var $win = $(win),        $handle = $('#js-pageHandle'),        $page = $handle.find('.page'),        aYpos = [],        screenH = $win.height();    $page.each(function (idx) {        "use strict";        aYpos[idx] = (idx * screenH * -1) +'px';    });    function scrollingPage(hashNumber, callback){        "use strict";        $handle.stop().animate({            'top' : aYpos[hashNumber-1]        },0,function(){            callback && callback(hashNumber);        });    }    function startAni(pageNum){        "use strict";        var idx = pageNum-1;        var $targetPage = $page.eq(idx);        var $currentObjs = $targetPage.find('.obj');        var objIdx = 0;        $page.find('.obj').removeClass('active').find('.obj-talk').removeClass('active');        $currentObjs.eq(objIdx).addClass('active').find('.obj-talk').addClass('active');        $currentObjs.bind('oanimationend animationend webkitAnimationEnd', function() {            var $this = $(this);            objIdx = $this.index()+1;            if(objIdx >= $currentObjs.length){                objIdx = 0;            }            $this.removeClass('active').find('.obj-talk').removeClass('active');            setTimeout(function(){                $currentObjs.eq(objIdx).addClass('active').find('.obj-talk').addClass('active');            },800);        });        $page.find('video').each(function(){           $(this).get(0).pause();        });        if( $targetPage.find('video').length ){            $targetPage.find('video').get(0).play();        }    }    $win.on('hashchange',function(e){        var targetPage = Number( location.hash.substr(1) ) || 1;        //scrollingPage(targetPage, startAni);        scrollingPage(4, startAni);    }).trigger('hashchange');    window.PAGE = function (nPageNum) {        "use strict";        location.hash = nPageNum || 1;    }})(window,document,jQuery);